!function(){"use strict";angular.module("auth",[]).config(["$stateProvider",function(e){e.state("login",{url:"/login",cache:!1,templateUrl:"app/auth/auth.html",controller:"AuthCtrl as vm",data:{noRequiresLogin:!0}})}])}(),function(){"use strict";function e(e,a,t,o,n){function i(){l.logo=!0}function s(){l.logo=!1}function r(){function i(e){if(!0!==e.data.respuesta)return o.hide(),c(e.data.message),!1;o.hide(),n.clearHistory(),n.nextViewOptions({disableBack:!0,historyRoot:!0}),a.go(t)}function s(e){o.hide(),c("Tiempo de respuesta agotado, verifique su conexion")}if(void 0===l.usuario.user||""===l.usuario.user)return c("Ingresar Usuario"),0;if(void 0===l.usuario.clave||""===l.usuario.clave)return c("Ingresar Contraseña"),0;o.show();var r={email:l.usuario.user,password:l.usuario.clave,regId:localStorage.getItem("regId")};e.login(r).then(i,s)}function c(e){o.show({template:e,noBackdrop:!0,duration:2e3})}var l=this;l.usuario={},l.logo=!1,l.iniciarSesion=r,l.hideLogo=i,l.showLogo=s}angular.module("auth").controller("AuthCtrl",["authService","$state","HOME","$ionicLoading","$ionicHistory",e])}(),function(){"use strict";angular.module("gestion",[]).config(["$stateProvider",function(e){e.state("usuario.gestion",{url:"/gestionReservas",templateUrl:"app/gestion/gestion.html",controller:"gestionCtrl as vm"})}])}(),function(){"use strict";function e(e,a,t,o,n,i,s,r,c){function l(){g.closeModal(),g.v_reserva.estadisticas=g.v_estadisticas,localStorage.setItem("reservaMover",JSON.stringify(g.v_reserva)),c.go("usuario.reservar")}function d(e,a){var t={idCliente:e,estado:a,sitio:n.getIdSitio()};o.recordar(t).then(function(e){m(e.data.message)},function(e){m(401==e.status?e.data.respuesta:"Ha ocurrido un problema al enviar la notificación!")})}function u(){g.nuevasSolicitudes=[],g.esperandoConfirmacion=[],g.confirmadas=[],e.show(),o.getBySitio(n.getIdSitio()).then(function(a){if(e.hide(),a.data.length>0){var t=0;for(t=0;t<a.data.length;t++)"esperandorevision"==a.data[t].estado?g.nuevasSolicitudes.push(a.data[t]):"esperandoconfirmacion"==a.data[t].estado?g.esperandoConfirmacion.push(a.data[t]):"confirmadaconabono"!=a.data[t].estado&&"confirmadasinabono"!=a.data[t].estado||g.confirmadas.push(a.data[t])}else m("No hay reservas en proceso!")},function(e){m(401==e.status?e.data:"Ha ocurrido un problema!")}).finally(function(){a.$broadcast("scroll.refreshComplete")})}function v(e){g.v_reserva=e,a.modal.show(),null!==document.getElementById("pago")&&(document.getElementById("pago").value=parseInt(g.v_reserva.precio-g.v_reserva.abonoLiquidado))}function m(a){e.show({template:a,noBackdrop:!0,duration:2e3})}function v(e){null!==document.getElementById("pago")&&(document.getElementById("pago").value=parseInt(g.v_reserva.precio-g.v_reserva.abonoLiquidado)),g.v_reserva=e,a.modal.show()}function p(a,t){var n="",i="";switch(a){case 1:if(""===document.getElementById("valorReserva").value)return void m("Informale a tu cliente el valor de la cancha!");a="esperandoconfirmacion";var s=parseInt(document.getElementById("valorReserva").value.split(".").join("")),c=0;""!==document.getElementById("abonoRequerido").value&&(c=parseInt(document.getElementById("abonoRequerido").value.split(".").join(""))),n={estado:a,idReserva:t,valor:s,abono:c},i="Se ha enviado la solicitud de confirmación a tu cliente";break;case 2:if(""===document.getElementById("masAbono").value)return void m("Debes registrar el abono!");a="confirmadaconabono";var l=parseInt(document.getElementById("masAbono").value.split(".").join(""));n={estado:a,idReserva:t,valor:!1,abono:l},i="Esta reserva ha sido confirmada y ha sido registrado su abono";break;case 3:a="confirmadasinabono",n={estado:a,idReserva:t,valor:!1,abono:!1};break;case 4:a="cancelada",n={estado:a,idReserva:t,valor:!1,abono:!1,emisor:"SITIO",detonador:1},i="Su reserva ha sido cancelada";break;case 5:if(a="cumplida",""===document.getElementById("pago").value||0===document.getElementById("pago").value)return void m("Ingrese el valor que se pagó");var d=parseInt(document.getElementById("pago").value.split(".").join(""));n={estado:a,idReserva:t,valor:!1,abono:!1,pago:d},i="La reserva ha sido cumplida";break;case 6:a="incumplida",n={estado:a,idReserva:t,valor:!1,abono:!1},i="La reserva ha sido incumplida"}if("cancelada"===a){r.confirm({title:"Cancelar reserva",template:'<img src="img/pregunta.svg" width="30%"><br> Está seguro que desea cancelar esta reserva?',buttons:[{text:"NO",type:"button-default",onTap:function(e){m("Cancelacion abortada")}},{text:"<b>Si, cancelar</b>",type:"button-positive",onTap:function(a){e.show(),o.updateReservas(n).then(function(a){e.hide(),1==a.data.respuesta&&(g.closeModal(),document.getElementsByTagName("body")[0].classList.remove("modal-open"),f("Buen Trabajo!",i),g.getReservas())},function(a){e.hide(),401==a.status?f("Oops",a.data.respuesta):f("Oops...","Ha ocurrido un problema!")})}}]})}else{e.show();o.updateReservas(n).then(function(a){e.hide(),1==a.data.respuesta&&(g.closeModal(),document.getElementsByTagName("body")[0].classList.remove("modal-open"),f("Buen Trabajo!",i),g.getReservas())},function(a){e.hide(),401==a.status?f("Oops",a.data.respuesta):f("Oops...","Ha ocurrido un problema!")})}}function f(e,a){r.alert({title:e,template:a}).then(function(e){})}function h(){a.modal.hide()}var g=this;a.$on("$ionicView.loaded",function(){g.getReservas=u,g.viewReserva=v,g.closeModal=h,g.actualizarEstadoGestion=p,g.moverReserva=l,g.recordar=d,g.nuevasSolicitudes=[],g.esperandoConfirmacion=[],g.confirmadas=[],g.v_reserva={},g.dinero={},g.fechaHoy="",a.$on("$ionicView.beforeEnter",function(e,a){u()}),t.fromTemplateUrl("modalReserva.html",{scope:a,animation:"zoom-from-center"}).then(function(e){a.modal=e}),Date.prototype.toDateInputValue=function(){var e=new Date(this);return e.setMinutes(this.getMinutes()-this.getTimezoneOffset()),e.toJSON().slice(0,10)},g.fechaHoy=(new Date).toDateInputValue()}),PushNotification.init({android:{senderID:"991363187494",vibrate:!0,sound:!0,alert:!0,badge:!0},ios:{alert:"true",badge:"true",sound:"true"}}).on("notification",function(e){r.confirm({title:"Notificación",template:e.message,buttons:[{text:"Entendido",type:"button-positive",onTap:function(e){u()}}]})}),a.changetab=function(e){i.select(e)},a.changeSlide=function(e){i.select(e),s.slide(e)}}angular.module("gestion").controller("gestionCtrl",["$ionicLoading","$scope","$ionicModal","reservasService","sessionService","$ionicTabsDelegate","$ionicSlideBoxDelegate","$ionicPopup","$state",e])}(),function(){"use strict";angular.module("historial",[]).config(["$stateProvider",function(e){e.state("usuario.historial",{url:"/historial",templateUrl:"app/historial/historial.html",controller:"historialCtrl as vm"})}])}(),function(){"use strict";function e(e,a,t,o,n){function i(){a.modal.show()}function s(){a.modal.hide()}function r(){a.modalReserva.hide()}function c(){v.estadisticasReservas.incumplidas=0,v.estadisticasReservas.canceladas=0,v.estadisticasReservas.cumplidas=0,v.estadisticasReservas.espera=0,o.getEstadisticasByFecha(n.getIdSitio(),v.fecha1.toDateInputValue(),v.fecha2.toDateInputValue()).then(function(e){var a=0;for(a=0;a<e.data.reservas.length;a++)"confirmadasinabono"!==e.data.reservas[a].estado&&"confirmadaconabono"!==e.data.reservas[a].estado||(v.estadisticasReservas.espera+=parseInt(e.data.reservas[a].cantidad)),"cumplida"===e.data.reservas[a].estado&&(v.estadisticasReservas.cumplidas=parseInt(e.data.reservas[a].cantidad)),"incumplida"===e.data.reservas[a].estado&&(v.estadisticasReservas.incumplidas=parseInt(e.data.reservas[a].cantidad)),"cancelada"===e.data.reservas[a].estado&&(v.estadisticasReservas.canceladas=parseInt(e.data.reservas[a].cantidad))},function(e){d(401==e.status?e.data.respuesta:"Ha ocurrido un problema!")})}function l(){e.show(),o.getHistorial(n.getIdSitio(),v.fecha1.toDateInputValue(),v.fecha2.toDateInputValue()).then(function(a){v.reservas=a.data.reservas,e.hide(),c(),v.finanzas.expectativa=parseInt(a.data.finanzas.posibleEntrada),v.finanzas.realidad=parseInt(a.data.finanzas.dineroEntrante),v.finanzas.abonos=parseInt(a.data.finanzas.abonos)},function(e){d(401==e.status?e.data.respuesta:"Conexión lenta, intente nuevamente")})}function d(a){e.show({template:a,noBackdrop:!0,duration:2e3})}function u(e){v.v_reserva=e,a.modalReserva.show()}var v=this;v.finanzas={},v.estadisticasReservas={},v.fecha1=new Date,v.fecha2=new Date,v.getReservas=l,v.openModal=i,v.closeModal=s,v.closeModalReserva=r,v.viewReserva=u,v.v_reserva={},v.v_estadisticas={},t.fromTemplateUrl("modalReservas.html",{scope:a,animation:"slide-in-up"}).then(function(e){a.modal=e}),t.fromTemplateUrl("reserva.html",{scope:a,animation:"zoom-from-center"}).then(function(e){a.modalReserva=e}),Date.prototype.toDateInputValue=function(){var e=new Date(this);return e.setMinutes(this.getMinutes()-this.getTimezoneOffset()),e.toJSON().slice(0,10)},l()}angular.module("historial").controller("historialCtrl",["$ionicLoading","$scope","$ionicModal","reservasService","sessionService",e])}(),function(){"use strict";angular.module("home",[]).config(["$stateProvider",function(e){e.state("usuario.home",{url:"/home",cache:!1,templateUrl:"app/home/home.html",controller:"homeCtrl as vm"}).state("usuario.detalleHoy",{url:"/home/detalle",cache:!1,templateUrl:"app/home/detalle.html",controller:"homeCtrl as vm"})}])}(),function(){"use strict";function e(e,a,t,o,n,i,s){function r(){if(null==window.localStorage.getItem("canchas")){o.get(n.getIdSitio()).then(function(e){0==e.data.canchas.length?f("No hay canchas registradas"):(window.localStorage.setItem("precios",JSON.stringify(e.data.precios)),window.localStorage.setItem("canchas",JSON.stringify(e.data.canchas)),g.Canchas=e.data.canchas)},function(e){f(401==e.status?e.data.respuesta:"Ha ocurrido un problema!")})}}function c(e,a){var o={idCliente:e,estado:a,sitio:n.getIdSitio()};t.recordar(o).then(function(e){f(e.data.message)},function(e){f(401==e.status?e.data.respuesta:"Ha ocurrido un problema al enviar la notificación!")})}function l(a,o){var n="",i="",r="";switch(a){case 1:r="cumplida";var c=parseInt(document.getElementById("pago").value.split(".").join(""));if(""===document.getElementById("pago").value||0===document.getElementById("pago").value)return f("Ingrese el valor que se pagó"),!1;n={estado:r,idReserva:o,valor:!1,abono:!1,pago:c},i="La reserva ha sido cumplida";break;case 0:r="incumplida",n={estado:r,idReserva:o,valor:!1,abono:!1},i="La reserva ha sido incumplida"}s.confirm({title:"Cambiar Estado",template:'<img src="img/pregunta.svg" width="30%"><br> Está seguro que desea cambiar el estado de reserva a: <b>'+r+"</b>",buttons:[{text:"Cancelar",type:"button-default",onTap:function(e){f("Movimiento cancelado")}},{text:"<b>Si</b>",type:"button-positive",onTap:function(a){function o(a){e.hide(),!0===a.data.respuesta&&(g.closeModal(),document.getElementsByTagName("body")[0].classList.remove("modal-open"),h("Buen Trabajo!",i),g.getReservasHoy())}function s(a){return e.hide(),401==a.status?void h("Oops",a.data.respuesta):void h("Oops...","Ha ocurrido un problema!")}e.show(),t.updateReservas(n).then(o,s)}}]})}function d(){var e=new Date,t=e.getHours(),o=e.getMinutes(),n=e.getSeconds();t<10&&(t=0+String(t)),o<10&&(o=0+String(o)),n<10&&(n=0+String(n)),a.$apply(function(){a.time=t+":"+o+":"+n,a.hora=parseInt(t)})}function u(e){g.v_reserva=e,a.modal.show()}function v(){a.modal.hide()}function m(){g.estadisticasReservas.incumplidas=0,g.estadisticasReservas.canceladas=0,g.estadisticasReservas.cumplidas=0,g.estadisticasReservas.espera=0;var e=(new Date).toDateInputValue();t.getEstadisticasByFecha(n.getIdSitio(),e,e).then(function(e){var a=0;for(a=0;a<e.data.reservas.length;a++)"confirmadasinabono"!==e.data.reservas[a].estado&&"confirmadaconabono"!==e.data.reservas[a].estado||(g.estadisticasReservas.espera+=parseInt(e.data.reservas[a].cantidad)),"cumplida"===e.data.reservas[a].estado&&(g.estadisticasReservas.cumplidas=parseInt(e.data.reservas[a].cantidad)),"incumplida"===e.data.reservas[a].estado&&(g.estadisticasReservas.incumplidas=parseInt(e.data.reservas[a].cantidad)),"cancelada"===e.data.reservas[a].estado&&(g.estadisticasReservas.canceladas=parseInt(e.data.reservas[a].cantidad))},function(e){f(401==e.status?e.data.respuesta:"Ha ocurrido un problema!")})}function p(){setInterval(d,1e3);var o=(new Date).toDateInputValue();e.show(),t.getByFechaAll(n.getIdSitio(),o).then(function(a){m(),e.hide(),g.finanzas.expectativa=parseInt(a.data.finanzas.posibleEntrada),g.finanzas.realidad=parseInt(a.data.finanzas.dineroEntrante),g.finanzas.abonos=parseInt(a.data.finanzas.abonos),0===a.data.length?(f("No hay reservas : "+o),g.reservas=a.data.reservas,g.finanzas.expectativa=0,g.finanzas.realidad=0):g.reservas=a.data.reservas},function(e){f(401==e.status?"Iniciar sesión":"Conexión lenta, intente nuevamente")}).finally(function(){a.$broadcast("scroll.refreshComplete")})}function f(a){e.show({template:a,noBackdrop:!0,duration:2e3})}function h(e,a){s.alert({title:e,template:a}).then(function(e){})}var g=this;a.$on("$ionicView.loaded",function(){g.getReservasHoy=p,g.viewReserva=u,g.closeModal=v,g.actualizarEstado=l,g.recordarReserva=c,r(),g.finanzas={},g.estadisticasReservas={},g.v_reserva={},g.reservas=[],a.time="",a.hora="",g.network=!0,Date.prototype.toDateInputValue=function(){var e=new Date(this);return e.setMinutes(this.getMinutes()-this.getTimezoneOffset()),e.toJSON().slice(0,10)},i.fromTemplateUrl("modalReservaHome.html",{scope:a,animation:"zoom-from-center"}).then(function(e){a.modal=e})}),a.$on("$ionicView.beforeEnter",function(e,a){p()})}angular.module("home").controller("homeCtrl",["$ionicLoading","$scope","reservasService","canchaService","sessionService","$ionicModal","$ionicPopup",e])}(),function(){"use strict";function e(e,a,t,o){function n(){e.logout().then(function(e){i("sesión finalizada!"),o.go("login",{},{reload:!0})},function(e){messge(e.data.error)})}function i(e){a.show({template:e,noBackdrop:!0,duration:2e3})}var s=this;s.sitio={},s.logout=n,s.sitio=JSON.parse(localStorage.getItem("data")),s.sitio.email=localStorage.getItem("email"),s.isActive=function(e){return e===t.path()}}angular.module("app").controller("MenuCtrl",["authService","$ionicLoading","$location","$state",e])}(),function(){"use strict";angular.module("reservar",[]).config(["$stateProvider",function(e){e.state("usuario.reservar",{url:"/reservar",templateUrl:"app/reservar/reservar.html",controller:"reservarCtrl as vm"})}])}(),function(){"use strict";function e(e,a,t,o,n,i,s,r,c){function l(){var e=dia_semana(B.fecha.toDateInputValue());B.diaSemana=B.dias[e]}function d(){e.show(),localStorage.removeItem("reservaMover"),B.reservaMover.existe=!1,B.RESERVA=[],B.Cliente={},B.Cliente.existe=!1,B.closeModal(),B.horas=[],setTimeout(function(){B.horas=[5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],a.changeSlide(1),a.changeSlide(0),e.hide()},500)}function u(){if(""===document.getElementById("precio0").value||""===document.getElementById("abonoRequerido0").value)return V("No se ha ingresado el valor de la reserva o el abono requedo o abono liquidado?"),!1;var a={precio:parseInt(document.getElementById("precio0").value.split(".").join("")),abonoRequerido:parseInt(document.getElementById("abonoRequerido0").value.split(".").join("")),fecha:B.RESERVA[0].fecha,hora:B.RESERVA[0].hora,usuario:localStorage.getItem("email"),diaSemana:B.RESERVA[0].diaSemana,cancha:B.RESERVA[0].idcancha,idReserva:B.RESERVA[0].id};e.show(),n.actualizarFecha(a).then(function(a){e.hide(),!0===a.data.respuesta?(localStorage.removeItem("reservaMover"),B.reservaMover.existe=!1,S("Buen trabajo!",a.data.message),B.RESERVA=[],B.Cliente={},B.Cliente.existe=!1,B.closeModal(),document.getElementsByTagName("body")[0].classList.remove("modal-open"),I()):V(a.data.message)},function(a){e.hide(),V(401==a.status?a.data.respuesta:"Ha ocurrido un problema!")})}function v(){e.show(),B.closeModal(),B.RESERVA=[],B.Cliente={},B.Cliente.existe=!1,B.horas=[],setTimeout(function(){B.horas=[5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],a.changeSlide(1),a.changeSlide(0),e.hide()},500)}function m(e){var a=new Date(B.fecha),t="";"+"===e&&(t=new Date(a.getTime()+864e5)),"-"===e&&(t=new Date(a.getTime()-864e5)),B.fecha=new Date(t),I()}function p(e,a){var t=0,o=!1;for(t=0;t<B.reservadas.length;t++){if(parseInt(B.reservadas[t].hora)===e&&B.reservadas[t].idCancha===a){o=!0;break}o=!1}return o}function f(e,a){var t=document.getElementById("fechaReserva").value,o="",n=0,i=!1,s=dia_semana(B.fecha.toDateInputValue()),r=B.dias[s],c=new Date,l=c.getFullYear()+"-"+(c.getMonth()+1)+"-"+c.getDate(),d=dateComapreTo(l,document.getElementById("fechaReserva").value),u=e-c.getHours();if(d>0){V("Imposible devolver el tiempo");var v="check_"+a+"_"+e+"_"+t;return document.getElementById(v).checked=!1,!1}if(u<0&&d>=0){V("Imposible devolver el tiempo");var v="check_"+a+"_"+e+"_"+t;return document.getElementById(v).checked=!1,!1}if(null!==localStorage.getItem("reservaMover")){B.RESERVA[0].idcancha=a,B.RESERVA[0].hora=e,B.RESERVA[0].fecha=t;var m=JSON.parse(localStorage.getItem("canchas")),p=0;for(p=0;p<m.length;p++)parseInt(a)===parseInt(m[p].id)&&(B.RESERVA[0].nombreCancha=m[p].nombre);B.RESERVA[0].diaSemana=r}else{if(B.RESERVA.length>0){var p=0;for(p=0;p<B.RESERVA.length;p++)B.RESERVA[p].idcancha===a&&B.RESERVA[p].hora===e&&B.RESERVA[p].fecha===t&&(B.RESERVA.splice(p,1),i=!0)}if(!1===i){var m=JSON.parse(localStorage.getItem("canchas")),f=JSON.parse(localStorage.getItem("precios")),p=0;for(p=0;p<m.length;p++)if(parseInt(a)===parseInt(m[p].id)&&(o=m[p].nombre,parseInt(f[p].cancha)===parseInt(a))){var h=0,g=f[p].precios;for(h=0;h<g.length;h++)if(g[h].HORA===e+":00"){r=r.replace(/á/gi,"a");for(var s=r.toUpperCase(),R=g[h],I=Object.keys(R),p=0;p<I.length;p++)if(I[p]===s){var b=I[p],S=g[h][b];S=S.toString()+".",n=parseInt(S.split(".").join(""));break}}}var E={idcancha:a,nombreCancha:o,fecha:t,diaSemana:r,hora:e,precio:parseInt(n)};B.RESERVA.push(E)}}}function h(){a.modal.show()}function g(){if(void 0!==B.Cliente.telefono&&""!==B.Cliente.telefono){i.getByPhone(B.Cliente.telefono).then(function(e){if(!1===e.data.respuesta)return B.Cliente.nombres="",B.Cliente.existe=!1,!1;!0===e.data.respuesta&&(B.Cliente.nombres=e.data.cliente.nombres,B.Cliente.apellidos=e.data.cliente.apellidos,B.Cliente.image=e.data.cliente.image,B.Cliente.url=e.data.cliente.url,B.Cliente.cumplidas=e.data.cliente.cumplidas,B.Cliente.incumplidas=e.data.cliente.incumplidas,B.Cliente.canceladas=e.data.cliente.canceladas,B.Cliente.resenia=e.data.cliente.resenia,B.Cliente.telefono=parseInt(e.data.cliente.telefono),B.Cliente.existe=!0)},function(e){V(401===e.status?e.data.respuesta:"Ha ocurrido un problema!")})}}function R(){a.modal.hide()}function I(){l(),e.show(),B.Fecha_r=B.fecha.toDateInputValue(),n.getByFecha(c.getIdSitio(),B.Fecha_r).then(function(a){e.hide(),0===a.data.length?(B.reservadas=[],V("No hay reservas : "+B.Fecha_r)):B.reservadas=a.data,setTimeout(function(){if(B.RESERVA.length>0&&null==window.localStorage.getItem("reservaMover")){var e=0;for(e=0;e<B.RESERVA.length;e++)if(B.RESERVA[e].fecha===B.fecha.toDateInputValue()){var a="check_"+B.RESERVA[e].idcancha+"_"+B.RESERVA[e].hora+"_"+B.RESERVA[e].fecha;document.getElementById(a).checked=!0}}},500)},function(a){e.hide(),V(401==a.status?a.data.respuesta:"Ha ocurrido un problema!")})}function b(){var a=!1,t="",o=[];if(void 0===B.Cliente.nombres||void 0===B.Cliente.telefono)V("Aun faltan datos del cliente?");else{var i="SIMPLE";B.RESERVA.length>1&&(i="COMPUESTA");var s=0;for(s=0;s<B.RESERVA.length;s++){if(""===document.getElementById("precio"+s).value||""===document.getElementById("abonoRequerido"+s).value)return V("No se ha ingresado el valor de la reserva o el abono requedo o abono liquidado?"),a=!1,!1;a=!0}if(!0===a){for(s=0;s<B.RESERVA.length;s++)t={precio:parseInt(document.getElementById("precio"+s).value.split(".").join("")),abonoRequerido:parseInt(document.getElementById("abonoRequerido"+s).value.split(".").join("")),estado:"confirmadasinabono"},o.push(t);var r={nombre:B.Cliente.nombre,resenia:B.Cliente.resenia,telefono:B.Cliente.telefono.toString(),reserva:B.RESERVA,sitio:c.getIdSitio(),usuario:localStorage.getItem("email"),via:"LOCAL",tipo:i,detalle:o};e.show();n.post(r).then(function(a){e.hide(),!0===a.data.respuesta?(S("Buen trabajo!",a.data.message),B.closeModal(),document.getElementsByTagName("body")[0].classList.remove("modal-open"),B.RESERVA=[],B.Cliente={},r={},o=[],B.Cliente.existe=!1,I()):V(a.data.message)},function(a){e.hide(),V(401==a.status?a.data.respuesta:"Ha ocurrido un problema!")})}}}function S(e,a){o.alert({title:e,template:a}).then(function(e){})}function E(t,o){var n=0,s=0;for(B.v_reserva={},n=0;n<B.reservadas.length;n++)if(parseInt(B.reservadas[n].hora)===parseInt(t)&&parseInt(B.reservadas[n].idCancha)===parseInt(o)){var r=JSON.parse(localStorage.getItem("canchas"));for(s=0;s<r.length;s++)if(r[s].id===B.reservadas[n].idCancha){var o=r[s].nombre;break}B.v_reserva=B.reservadas[n],B.v_reserva.nombrecancha=o,e.show();var c=i.get(B.reservadas[n].idCliente);c.then(function(t){B.v_cliente=t.data.cliente,e.hide(),a.modalReserva.show()},function(e){V(401==e.status?e.data.respuesta:"Ha ocurrido un problema!")});break}}function C(){a.modalReserva.hide()}function y(){B.Canchas=JSON.parse(window.localStorage.getItem("canchas")),setTimeout(function(){a.changeSlide(1),a.changeSlide(0)},100),setTimeout(function(){I()},200)}function w(){var e=JSON.parse(localStorage.getItem("reservaMover"));B.RESERVA.push({id:e.id,idcancha:e.idCancha,nombreCancha:e.nombrecancha,fecha:e.fecha,diaSemana:e.diaSemana,hora:e.hora}),B.Cliente.existe=!0,B.Cliente.image=e.image,B.Cliente.url=e.url,B.Cliente.telefono=parseInt(e.telefono),B.Cliente.nombres=e.nombres,B.Cliente.cumplidas=e.cumplidas,B.Cliente.resenia=e.resenia,B.Cliente.incumplidas=e.incumplidas,B.Cliente.canceladas=e.canceladas}function V(a){e.show({template:a,noBackdrop:!0,duration:2e3})}var B=this;a.$on("$ionicView.beforeEnter",function(e,a){B.horas=[5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],null!==window.localStorage.getItem("reservaMover")&&(B.reservaMover.existe=!0,w())}),a.$on("$ionicView.loaded",function(){B.viewReserva=E,B.getCanchas=y,B.moveToFecha=m,B.comprobarReservada=p,B.getAgendaDiaByCancha=I,B.cargarReserva=f,B.showReservasCargadas=h,B.closeModal=R,B.viewReserva=E,B.closeModalReserva=C,B.getCliente=g,B.reservar=b,B.limpiarReservas=v,B.cancelarActualizacion=d,B.actualizarReserva=u,B.dias=new Array("","Domingo","Lunes","Martes","Miercoles","Jueves","Viernes","Sábado"),B.fecha=new Date,B.diaSemana="",B.Fecha_r="",B.v_reserva={},B.v_cliente={},B.Cliente={},B.Cliente.existe=!1,B.Cancha={},B.Canchas=[],B.reservadas=[],B.RESERVA=[],B.reservaMover={},B.reservaMover.existe=!1,l(),t.fromTemplateUrl("modalReservaCargadas.html",{scope:a,animation:"slide-in-up"}).then(function(e){a.modal=e}),t.fromTemplateUrl("modalReserva.html",{scope:a,animation:"zoom-from-center"}).then(function(e){a.modalReserva=e}),y()}),a.changetab=function(e){r.select(e)},a.changeSlide=function(e){r.select(e),s.slide(e)},Date.prototype.toDateInputValue=function(){var e=new Date(this);return e.setMinutes(this.getMinutes()-this.getTimezoneOffset()),e.toJSON().slice(0,10)},Date.prototype.toDateInputValue=function(){var e=new Date(this);return e.setMinutes(this.getMinutes()-this.getTimezoneOffset()),e.toJSON().slice(0,10)}}angular.module("reservar").controller("reservarCtrl",["$ionicLoading","$scope","$ionicModal","$ionicPopup","reservasService","clienteService","$ionicSlideBoxDelegate","$ionicTabsDelegate","sessionService",e])}();